# README Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Create `README.md` (public npm-facing) and `docs/COMMANDS.md` (full command reference) for the whoop-sync project.

**Architecture:** Two markdown files. `README.md` covers everything a new user needs: install, setup, all commands in tables, key flags, real output examples, attribution. `docs/COMMANDS.md` is the full per-command reference with every flag and a real output example per command, linked from README. All output examples are captured live ‚Äî no fabrication.

**Tech Stack:** Markdown, whoop-sync CLI (`npm run dev -- <cmd>` from project root, `.env` already present, tokens at `~/.whoop-sync/tokens.json` already valid)

**Reference:** Design doc at `docs/plans/2026-02-18-readme-design.md`. Old project for attribution: https://github.com/xonika9/whoop-cli

---

## Task 1: Capture additional real CLI outputs

**Files:** none (capture to use in Tasks 2‚Äì3)

**Step 1: Run auth status**

```bash
npm run dev -- auth status
```

Expected: JSON with `authenticated: true`, `expires_at`, `expires_in_human`.
Save output.

**Step 2: Run sleep --pretty**

```bash
npm run dev -- sleep --days 1 --pretty
```

Expected: formatted sleep record(s) with stage breakdown.
Save output.

**Step 3: Run recovery --pretty**

```bash
npm run dev -- recovery --days 1 --pretty
```

Expected: formatted recovery record with HRV, RHR, SpO2.
Save output.

**Step 4: Run workout --pretty (or note if no workout)**

```bash
npm run dev -- workout --days 3 --pretty
```

Expected: formatted workout record, or empty list. Either is fine ‚Äî use whichever is non-empty; if empty try `--days 7`.
Save output.

**Step 5: Run default JSON output (recovery, no flags)**

```bash
npm run dev -- recovery --days 1
```

Expected: raw JSON array. Save the first record ‚Äî this becomes the JSON snippet in the README.

**Step 6: Run whoop-sync --help**

```bash
npm run dev -- --help
```

Save full help text output.

---

## Task 2: Write `README.md`

**Files:**
- Create: `README.md` (project root ‚Äî `/Volumes/storage/01_Projects/whoop/whoop-sync/README.md`)

**Step 1: Write the file**

Replace all `[OUTPUT_*]` placeholders with captured outputs from Task 1. The previously captured outputs (from `docs/plans/2026-02-18-readme-design.md`) are already available for summary, dashboard, trends, insights.

```markdown
# whoop-sync

[![npm version](https://img.shields.io/npm/v/whoop-sync.svg)](https://www.npmjs.com/package/whoop-sync)

CLI for WHOOP health data ‚Äî fetch, analyze, and visualize via the WHOOP API v2.

```bash
npm install -g whoop-sync
```

## Quick start

```bash
whoop-sync auth login                                 # authenticate via browser
whoop-sync summary --color                            # color-coded daily snapshot
whoop-sync dashboard                                  # full dashboard + 7-day trends
whoop-sync chart dashboard -n 30 -o /tmp/whoop.html  # interactive HTML chart
```

## Setup

1. Register a WHOOP application at [developer.whoop.com](https://developer.whoop.com)
   - Apps with fewer than 10 users don't need WHOOP review (immediate use)

2. Set environment variables ‚Äî create a `.env` file in your working directory:

```env
WHOOP_CLIENT_ID=your_client_id
WHOOP_CLIENT_SECRET=your_client_secret
WHOOP_REDIRECT_URI=https://your-redirect-uri.com/callback
```

3. Authenticate:

```bash
whoop-sync auth login
```

Tokens are stored at `~/.whoop-sync/tokens.json` and auto-refresh 15 minutes before expiry.

## Commands

### Auth

| Command | Description |
| --- | --- |
| `whoop-sync auth login` | OAuth flow ‚Äî opens browser, paste callback URL |
| `whoop-sync auth logout` | Revoke access on WHOOP server + clear local tokens |
| `whoop-sync auth status` | Show token expiry (does not refresh) |
| `whoop-sync auth refresh` | Force refresh access token using refresh token |

### Data

Output is JSON by default. Add `--pretty` for human-readable formatted output.

| Command | Description |
| --- | --- |
| `whoop-sync sleep` | Sleep stages, efficiency, respiratory rate |
| `whoop-sync recovery` | Recovery score, HRV, RHR, SpO2, skin temperature |
| `whoop-sync workout` | Workouts with strain, HR zones, calories |
| `whoop-sync cycle` | Daily physiological cycle (strain, calories) |
| `whoop-sync profile` | User info (name, email) |
| `whoop-sync body` | Body measurements (height, weight, max HR) |

### Analysis

Output is pretty-printed by default. Add `--json` for raw JSON.

| Command | Description |
| --- | --- |
| `whoop-sync summary` | Multi-day averages: recovery, HRV, RHR, sleep, strain |
| `whoop-sync summary --color` | Same with üî¥üü°üü¢ color-coded status indicators |
| `whoop-sync dashboard` | Full terminal dashboard with 7-day trends |
| `whoop-sync trends` | Multi-day trend analysis with direction arrows ‚Üë‚Üì‚Üí |
| `whoop-sync insights` | Health recommendations based on your recent data |

### Charts

Interactive HTML charts, opened in browser automatically. Use `-o file.html` to save instead.

| Command | Description |
| --- | --- |
| `whoop-sync chart sleep` | Sleep performance and stage breakdown |
| `whoop-sync chart recovery` | Recovery score and HRV over time |
| `whoop-sync chart strain` | Daily strain and calorie burn |
| `whoop-sync chart hrv` | HRV trend |
| `whoop-sync chart dashboard` | Combined overview (recommended) |

### Lookups

Fetch a single record by ID. IDs come from collection endpoint responses or `dashboard --json`.

| Command | Description |
| --- | --- |
| `whoop-sync get sleep <uuid>` | Full detail for one sleep record (UUID string) |
| `whoop-sync get workout <uuid>` | Full detail for one workout record (UUID string) |
| `whoop-sync get cycle <id>` | Full detail for one cycle (integer ID) |
| `whoop-sync cycle-sleep <cycleId>` | Sleep record linked to a given cycle |
| `whoop-sync cycle-recovery <cycleId>` | Recovery record linked to a given cycle |

## Flags

### Data command flags

| Flag | Description |
| --- | --- |
| `-n, --days <number>` | Days of history (default: 7) |
| `-d, --date <date>` | Specific date (YYYY-MM-DD) |
| `-s, --start <date>` | Range start date |
| `-e, --end <date>` | Range end date |
| `-l, --limit <n>` | Max results per page (max: 25) |
| `-a, --all` | Fetch all pages |
| `-p, --pretty` | Human-readable output |

### Analysis command flags

| Flag | Applies to | Description |
| --- | --- | --- |
| `-n, --days <number>` | all analysis | Days of history (default: 7) |
| `-c, --color` | summary | Color-coded status indicators |
| `--json` | dashboard, trends, insights | Raw JSON output |

### Chart flags

| Flag | Description |
| --- | --- |
| `-n, --days <number>` | Days of history to chart (default: 7) |
| `-o, --output <file>` | Save HTML to file instead of opening browser |

### Global flags (combine data types)

| Flag | Description |
| --- | --- |
| `--sleep` | Include sleep data |
| `--recovery` | Include recovery data |
| `--workout` | Include workout data |
| `--cycle` | Include cycle data |
| `--profile` | Include profile |
| `--body` | Include body measurements |

Running `whoop-sync` with no arguments fetches all data types.

## Example output

`whoop-sync summary --color`:
```
[OUTPUT_SUMMARY]
```

`whoop-sync dashboard`:
```
[OUTPUT_DASHBOARD]
```

`whoop-sync trends --days 7`:
```
[OUTPUT_TRENDS]
```

`whoop-sync insights`:
```
[OUTPUT_INSIGHTS]
```

`whoop-sync recovery` (default JSON):
```json
[OUTPUT_RECOVERY_JSON]
```

## Token management

`whoop-sync auth status` **does not refresh tokens** ‚Äî it only reports expiry.

For cron jobs or automation:

```bash
# Recommended pattern
whoop-sync auth refresh   # ensure fresh token before fetching
whoop-sync dashboard --json
```

If refresh fails with an expired refresh token, re-authenticate interactively:

```bash
whoop-sync auth login
```

## Exit codes

| Code | Meaning |
| --- | --- |
| 0 | Success |
| 1 | General error |
| 2 | Authentication error |
| 3 | Rate limit exceeded |
| 4 | Network error |

## Development

```bash
git clone https://github.com/mrkhachaturov/whoop-sync.git
cd whoop-sync
npm install

npm run dev -- dashboard    # run without building
npm run build               # compile TypeScript ‚Üí dist/
npm test                    # run test suite
```

Node.js 22+ required.

## Full command reference

‚Üí [docs/COMMANDS.md](docs/COMMANDS.md)

## Attribution

Built on top of [whoop-cli](https://github.com/xonika9/whoop-cli) by [xonika9](https://github.com/xonika9).

## License

MIT
```

**Step 2: Verify the file was written**

```bash
head -5 README.md
```

Expected: `# whoop-sync` followed by npm badge line.

**Step 3: Confirm no placeholders remain**

```bash
grep -n "OUTPUT_" README.md
```

Expected: zero matches.

---

## Task 3: Write `docs/COMMANDS.md`

**Files:**
- Create: `docs/COMMANDS.md`

**Step 1: Write the file**

Replace all `[OUTPUT_*]` placeholders with captured outputs from Task 1 and the design doc.

```markdown
# whoop-sync ‚Äî Full Command Reference

‚Üê [Back to README](../README.md)

---

## Auth commands

### `auth login`

OAuth 2.0 authorization code flow. Opens browser; paste the callback URL when prompted.

```bash
whoop-sync auth login
```

### `auth logout`

Revokes access on the WHOOP server, then clears `~/.whoop-sync/tokens.json`.

```bash
whoop-sync auth logout
```

### `auth status`

Reports token expiry without refreshing.

```bash
whoop-sync auth status
```

Output:
```json
[OUTPUT_AUTH_STATUS]
```

### `auth refresh`

Forces a token refresh using the stored refresh token.

```bash
whoop-sync auth refresh
```

---

## Data commands

All data commands output JSON by default. Add `--pretty` for formatted output.

### Shared flags

| Flag | Description |
| --- | --- |
| `-n, --days <number>` | Days of history (default: 7) |
| `-d, --date <date>` | Specific date (YYYY-MM-DD) |
| `-s, --start <date>` | Range start date |
| `-e, --end <date>` | Range end date |
| `-l, --limit <n>` | Max results per page (max: 25) |
| `-a, --all` | Fetch all pages (pagination) |
| `-p, --pretty` | Human-readable formatted output |

### `sleep`

Sleep stages, efficiency, respiratory rate, disturbances.

```bash
whoop-sync sleep --days 7 --pretty
```

Output:
```
[OUTPUT_SLEEP_PRETTY]
```

### `recovery`

Recovery score, HRV (rMSSD), resting heart rate, SpO2, skin temperature.

```bash
whoop-sync recovery --days 1 --pretty
```

Output:
```
[OUTPUT_RECOVERY_PRETTY]
```

Raw JSON (default):
```bash
whoop-sync recovery --days 1
```

```json
[OUTPUT_RECOVERY_JSON]
```

### `workout`

Workouts with sport name, strain, heart rate zones, calorie burn.

```bash
whoop-sync workout --days 7 --pretty
```

Output:
```
[OUTPUT_WORKOUT_PRETTY]
```

### `cycle`

Daily physiological cycle: strain score, calorie burn.

```bash
whoop-sync cycle --days 7 --pretty
```

### `profile`

User profile: name, email, user ID.

```bash
whoop-sync profile
```

### `body`

Body measurements: height, weight, max heart rate.

```bash
whoop-sync body
```

---

## Analysis commands

Analysis commands output pretty-printed text by default. Add `--json` for raw JSON.

### `summary`

Multi-day averages: recovery, HRV, RHR, sleep performance, sleep hours, strain.

```bash
whoop-sync summary [-n days]
```

| Flag | Description |
| --- | --- |
| `-n, --days <number>` | Days to summarize (default: 7) |
| `-c, --color` | Add üî¥üü°üü¢ color-coded indicators |
| `--json` | Raw JSON output |

`whoop-sync summary --color`:
```
[OUTPUT_SUMMARY]
```

### `dashboard`

Full terminal dashboard: today's recovery, sleep, strain + 7-day trend lines.

```bash
whoop-sync dashboard [--json]
```

Output:
```
[OUTPUT_DASHBOARD]
```

### `trends`

Multi-day trend analysis with averages, ranges, and direction arrows ‚Üë‚Üì‚Üí.

```bash
whoop-sync trends [-n 7|14|30] [--json]
```

`--days` only accepts **7, 14, or 30**.

`whoop-sync trends --days 7`:
```
[OUTPUT_TRENDS]
```

### `insights`

Health recommendations based on recent recovery, sleep, and strain patterns.

```bash
whoop-sync insights [-n days] [--json]
```

Output:
```
[OUTPUT_INSIGHTS]
```

---

## Chart commands

Interactive HTML charts using ApexCharts. Opens in browser by default.

```bash
whoop-sync chart <type> [-n days] [-o output.html]
```

| Type | Description |
| --- | --- |
| `sleep` | Sleep performance and stage breakdown |
| `recovery` | Recovery score and HRV over time |
| `strain` | Daily strain and calorie burn |
| `hrv` | HRV trend |
| `dashboard` | Combined overview (recommended) |

| Flag | Description |
| --- | --- |
| `-n, --days <number>` | Days of history (default: 7) |
| `-o, --output <file>` | Save to file instead of opening browser |

Examples:
```bash
whoop-sync chart dashboard -n 30 -o /tmp/whoop.html
whoop-sync chart hrv -n 90 -o /tmp/whoop-hrv.html
```

---

## Lookup commands

Fetch a single record by ID. Get IDs from collection responses or `dashboard --json`.

### `get sleep <uuid>`

Full detail for one sleep record. ID is a UUID string.

```bash
whoop-sync get sleep ecfc6a15-4661-442f-a9a4-f160dd7afae8
```

### `get workout <uuid>`

Full detail for one workout. ID is a UUID string.

```bash
whoop-sync get workout <uuid>
```

### `get cycle <id>`

Full detail for one cycle. ID is an integer.

```bash
whoop-sync get cycle 12345678
```

### `cycle-sleep <cycleId>`

Sleep record linked to a specific cycle (by integer cycle ID).

```bash
whoop-sync cycle-sleep 12345678
```

### `cycle-recovery <cycleId>`

Recovery record linked to a specific cycle (by integer cycle ID).

```bash
whoop-sync cycle-recovery 12345678
```

---

## Global flags

Combine data types in a single fetch:

```bash
whoop-sync --sleep --recovery --workout --cycle --profile --body
```

Running `whoop-sync` with no arguments fetches all data types.

---

## WHOOP day boundary

WHOOP considers a new day to start at **4:00 AM**, not midnight. Commands issued before 4 AM reference the previous calendar day.

---

‚Üê [Back to README](../README.md)
```

**Step 2: Verify**

```bash
head -5 docs/COMMANDS.md
```

Expected: `# whoop-sync ‚Äî Full Command Reference`.

**Step 3: Confirm no placeholders remain**

```bash
grep -n "OUTPUT_" docs/COMMANDS.md
```

Expected: zero matches.

---

## Task 4: Commit

**Step 1: Commit**

```bash
git add README.md docs/COMMANDS.md
git commit -m "docs: add README.md and full COMMANDS reference"
```

**Step 2: Verify**

```bash
git show --stat HEAD
```

Expected: 2 files added ‚Äî `README.md` and `docs/COMMANDS.md`.
